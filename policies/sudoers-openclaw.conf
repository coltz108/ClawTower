# ClawAV-hardened sudoers for OpenClaw agent
# Generated by ClawAV installer — do not edit manually

# Read-only system inspection (no shell escape risk)
# NOTE: find removed — find -exec gives arbitrary command execution
# NOTE: journalctl can shell escape via pager — restricted below
openclaw ALL=(ALL) NOPASSWD: /usr/bin/cat, /usr/bin/ls, /usr/bin/head, /usr/bin/tail, /usr/bin/grep, /usr/bin/stat, /usr/bin/wc, /usr/bin/diff, /usr/bin/file, /usr/bin/readlink, /usr/bin/getent, /usr/bin/id, /usr/bin/whoami, /usr/bin/test, /usr/bin/sort, /usr/bin/uniq, /usr/bin/tr, /usr/bin/cut, /usr/bin/md5sum, /usr/bin/sha256sum, /usr/bin/strings

# System monitoring (read-only, no shell escape)
openclaw ALL=(ALL) NOPASSWD: /usr/bin/journalctl, /usr/bin/dmesg, /usr/bin/ss, /usr/sbin/lsof, /usr/bin/lsof, /usr/bin/df, /usr/bin/du, /usr/bin/free, /usr/bin/uptime, /usr/bin/ps, /usr/bin/ip, /usr/sbin/ip

# Systemctl — status/start/restart only (no stop/disable/mask, no systemd-run)
openclaw ALL=(ALL) NOPASSWD: /usr/bin/systemctl status *, /usr/bin/systemctl is-active *, /usr/bin/systemctl show *, /usr/bin/systemctl list-units *, /usr/bin/systemctl list-timers *, /usr/bin/systemctl start *, /usr/bin/systemctl restart *, /usr/bin/systemctl enable *, /usr/bin/systemctl daemon-reload

# Package management — restricted subcommands only
# NOTE: apt-get -o allows arbitrary code execution via hooks — blocked
# apt/apt-get install/update/upgrade go through clawsudo for -o inspection
openclaw ALL=(ALL) NOPASSWD: /usr/bin/apt-cache, /usr/bin/dpkg -l, /usr/bin/dpkg -l *, /usr/bin/dpkg --list, /usr/bin/dpkg --list *, /usr/bin/dpkg -s, /usr/bin/dpkg -s *, /usr/bin/dpkg --status, /usr/bin/dpkg --status *

# All other privileged operations go through clawsudo
openclaw ALL=(ALL) NOPASSWD: /usr/local/bin/clawsudo *

# Explicit denials — belt and suspenders
openclaw ALL=(ALL) !ALL
